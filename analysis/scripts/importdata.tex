% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Import raw data},
  pdfauthor={Joao Marreiros},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Import raw data}
\author{Joao Marreiros}
\date{2022-12-20 09:32:50}

\begin{document}
\maketitle

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Brief description of the script}

This R markdown document imports and formats the output of the resulting
CSV file from the computing ISO 25178-2 parameters in ConfoMap. These
data is part of the manuscript: \emph{Dubreuil et al.~2023. A `Family of
Wear': Traceological Patterns on Pebbles Used for Burnishing Pots and
Processing Other Plastic Mineral Matters}

The script includes three steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Reads in the original CSV-file\\
\item
  Formats the data\\
\item
  Writes an XLSX-file and save an R object ready for further analysis in
  R
\end{enumerate}

This R project and respective scripts follow the procedures described by
Marwick et al.~2017.

The authors would like to thank Ivan Calandra and Lisa Schunk for their
help and contribution on several chunks of code included here in the
script (pieces of code are also adapted from Calandra et al.~2019,
Pedergnana et al.~2020a, 2020b).

To compile this markdown document do not delete or move files from their
original folders.

For any questions, comments and inputs, please contact:

Joao Marreiros,
\href{mailto:joao.marreiros@rgzm.de}{\nolinkurl{joao.marreiros@rgzm.de}}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{load-libraries}{%
\section{Load libraries}\label{load-libraries}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(openxlsx)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: package 'openxlsx' was built under R version 4.1.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tools)}
\FunctionTok{library}\NormalTok{(R.utils)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: package 'R.utils' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
Warning: package 'R.oo' was built under R version 4.1.3
\end{verbatim}

\begin{verbatim}
Warning: package 'R.methodsS3' was built under R version 4.1.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(chron)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: package 'chron' was built under R version 4.1.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dir\_in }\OtherTok{\textless{}{-}} \StringTok{"analysis/raw\_data/"}
\NormalTok{dir\_out }\OtherTok{\textless{}{-}} \StringTok{"analysis/derived\_data/"}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{get-file-names-path-and-info}{%
\section{Get file names, path and
info}\label{get-file-names-path-and-info}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_file }\OtherTok{\textless{}{-}} \FunctionTok{list.files}\NormalTok{(dir\_in, }\AttributeTok{pattern =} \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.csv$"}\NormalTok{, }\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{md5\_in }\OtherTok{\textless{}{-}} \FunctionTok{md5sum}\NormalTok{(data\_file)}
\end{Highlighting}
\end{Shaded}

\hypertarget{import-and-read-the-original-csv-file}{%
\section{Import and read the original
CSV-file}\label{import-and-read-the-original-csv-file}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{imp\_data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(data\_file, }\AttributeTok{header =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{na.strings =} \StringTok{"*****"}\NormalTok{, }\AttributeTok{encoding =} \StringTok{"latin1"}\NormalTok{)}
\FunctionTok{str}\NormalTok{(imp\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   33 obs. of  105 variables:
 $ V1  : chr  "#" "#" "#" "2021/04/15" ...
 $ V2  : chr  "#" "#" "#" "14:06:02" ...
 $ V3  : chr  "#" "#" "#" "D:\\Dropbox\\jmmarreiros_dropbox\\Work\\Papers and articles\\2021 - Debreuil et al Brunishing tools\\ConfocalDa"| __truncated__ ...
 $ V4  : chr  "OPERATOR:1" "X-axis rotation angle" "°" "1.389601332" ...
 $ V5  : chr  "OPERATOR:1" "Y-axis rotation angle" "°" "-3.540040607" ...
 $ V6  : chr  "OPERATOR:2" "a0" "µm" "-3.327279468" ...
 $ V7  : chr  "OPERATOR:2" "ax" "µm" "-0.007136344206" ...
 $ V8  : chr  "OPERATOR:2" "ax2" "µm" "6.08357491E-06" ...
 $ V9  : chr  "OPERATOR:2" "ax3" "µm" "-1.075360198E-09" ...
 $ V10 : chr  "OPERATOR:2" "ay" "µm" "0.004476105667" ...
 $ V11 : chr  "OPERATOR:2" "axy" "µm" "6.779964383E-07" ...
 $ V12 : chr  "OPERATOR:2" "ax2y" "µm" "-1.114150037E-09" ...
 $ V13 : chr  "OPERATOR:2" "ay2" "µm" "2.420272666E-06" ...
 $ V14 : chr  "OPERATOR:2" "axy2" "µm" "5.305851231E-10" ...
 $ V15 : chr  "OPERATOR:2" "ay3" "µm" "-1.457157799E-09" ...
 $ V16 : chr  "6" "Name" "<no unit>" "Kremasti4_LSM_50x_natural_a_Topo" ...
 $ V17 : chr  "6" "Created on" "<no unit>" "4/15/2021 10:24:41 AM" ...
 $ V18 : chr  "6" "Studiable type" "<no unit>" "Surface" ...
 $ V19 : chr  "6" "Axis name - X" "<no unit>" "X" ...
 $ V20 : chr  "6" "Axis length - X" "µm" "255.4748064" ...
 $ V21 : chr  "6" "Axis size - X" "points" "3000" ...
 $ V22 : chr  "6" "Axis spacing - X" "nm" "85.18666436" ...
 $ V23 : chr  "6" "Axis name - Y" "<no unit>" "Y" ...
 $ V24 : chr  "6" "Axis length - Y" "µm" "255.4748064" ...
 $ V25 : chr  "6" "Axis size - Y" "points" "3000" ...
 $ V26 : chr  "6" "Axis spacing - Y" "nm" "85.18666436" ...
 $ V27 : chr  "6" "Axis name - Z" "<no unit>" "Z" ...
 $ V28 : chr  "6" "Layer type - Z" "<no unit>" "Topography" ...
 $ V29 : chr  "6" "Axis length - Z" "µm" "40.71166716" ...
 $ V30 : chr  "6" "Axis size - Z" "digits" "65532" ...
 $ V31 : chr  "6" "Axis spacing - Z" "nm" "0.6212486596" ...
 $ V32 : chr  "6" "NM-points ratio - Z" "%" "0" ...
 $ V33 : chr  "15" "Name" "<no unit>" "Kremasti4_LSM_50x_natural_a_Topo > Leveled (LS-plane) > Form removed (LS-poly 3) > Outliers removed > Threshold"| __truncated__ ...
 $ V34 : chr  "15" "Created on" "<no unit>" "4/15/2021 10:24:41 AM" ...
 $ V35 : chr  "15" "Studiable type" "<no unit>" "Surface" ...
 $ V36 : chr  "15" "Axis name - X" "<no unit>" "X" ...
 $ V37 : chr  "15" "Axis length - X" "µm" "255.4748064" ...
 $ V38 : chr  "15" "Axis size - X" "points" "3000" ...
 $ V39 : chr  "15" "Axis spacing - X" "nm" "85.18666436" ...
 $ V40 : chr  "15" "Axis name - Y" "<no unit>" "Y" ...
 $ V41 : chr  "15" "Axis length - Y" "µm" "255.4748064" ...
 $ V42 : chr  "15" "Axis size - Y" "points" "3000" ...
 $ V43 : chr  "15" "Axis spacing - Y" "nm" "85.18666436" ...
 $ V44 : chr  "15" "Axis name - Z" "<no unit>" "Z" ...
 $ V45 : chr  "15" "Layer type - Z" "<no unit>" "Topography" ...
 $ V46 : chr  "15" "Axis length - Z" "µm" "12.32495216" ...
 $ V47 : chr  "15" "Axis size - Z" "digits" "198390" ...
 $ V48 : chr  "15" "Axis spacing - Z" "nm" "0.06212486596" ...
 $ V49 : chr  "15" "NM-points ratio - Z" "%" "0" ...
 $ V50 : chr  "17" "Sq" "µm" "1.584021467" ...
 $ V51 : chr  "17" "Ssk" "<no unit>" "-0.6095035235" ...
 $ V52 : chr  "17" "Sku" "<no unit>" "4.87649139" ...
 $ V53 : chr  "17" "Sp" "µm" "5.465869957" ...
 $ V54 : chr  "17" "Sv" "µm" "6.859082201" ...
 $ V55 : chr  "17" "Sz" "µm" "12.32495216" ...
 $ V56 : chr  "17" "Sa" "µm" "1.125056973" ...
 $ V57 : chr  "17" "Smr (c = 1 µm below highest peak)" "%" "0.4839345421" ...
 $ V58 : chr  "17" "Smc (p = 10%)" "µm" "1.693314186" ...
 $ V59 : chr  "17" "Sxp (p = 50%  q = 97.5%)" "µm" "3.99094246" ...
 $ V60 : chr  "17" "Sal (s = 0.2)" "µm" "19.51575135" ...
 $ V61 : chr  "17" "Str (s = 0.2)" "<no unit>" "0.480092466" ...
 $ V62 : chr  "17" "Std (Reference angle = 0°)" "°" "42.24936206" ...
 $ V63 : chr  "17" "Sdq" "<no unit>" "0.3826728109" ...
 $ V64 : chr  "17" "Sdr" "%" "6.003094867" ...
 $ V65 : chr  "17" "Vm (p = 10%)" "µm³/µm²" "0.08953456587" ...
 $ V66 : chr  "17" "Vv (p = 10%)" "µm³/µm²" "1.782866126" ...
 $ V67 : chr  "17" "Vmp (p = 10%)" "µm³/µm²" "0.08953456587" ...
 $ V68 : chr  "17" "Vmc (p = 10%  q = 80%)" "µm³/µm²" "1.129500923" ...
 $ V69 : chr  "17" "Vvc (p = 10%  q = 80%)" "µm³/µm²" "1.496020162" ...
 $ V70 : chr  "17" "Vvv (p = 80%)" "µm³/µm²" "0.2868459635" ...
 $ V71 : chr  "18" "Maximum depth of furrows" "µm" "7.217169929" ...
 $ V72 : chr  "18" "Mean depth of furrows" "µm" "1.568997462" ...
 $ V73 : chr  "18" "Mean density of furrows" "cm/cm2" "3750.457168" ...
 $ V74 : chr  "19" "First direction" "°" "89.9771993" ...
 $ V75 : chr  "19" "Second direction" "°" "45.01151178" ...
 $ V76 : chr  "19" "Third direction" "°" "179.9901922" ...
 $ V77 : chr  "20" "Texture isotropy" "%" "73.9724373" ...
 $ V78 : chr  "21" "Length-scale anisotropy (Sfrax) (epLsar)" "<no unit>" NA ...
 $ V79 : chr  "21" "Length-scale anisotropy (NewEplsar)" "<no unit>" NA ...
 $ V80 : chr  "22" "Fractal complexity (Asfc)" "<no unit>" "9.933672877" ...
 $ V81 : chr  "22" "Scale of max complexity (Smfc)" "nm²" "6281984.839" ...
 $ V82 : chr  "22" "HAsfc9 (HAsfc9)" "<no unit>" "0.5388613394" ...
 $ V83 : chr  "22" "HAsfc81 (HAsfc81)" "<no unit>" "0.8700496629" ...
 $ V84 : chr  "128" "Name" "<no unit>" "Kremasti4_LSM_50x_natural_a_Topo > Leveled (LS-plane) > Form removed (LS-poly 3) > Outliers removed > Threshold"| __truncated__ ...
 $ V85 : chr  "128" "File path" "<no unit>" "D:\\Dropbox\\jmmarreiros_dropbox\\Work\\Papers and articles\\2021 - Debreuil et al Brunishing tools\\ConfocalDa"| __truncated__ ...
 $ V86 : chr  "128" "Created on" "<no unit>" "4/15/2021 10:24:41 AM" ...
 $ V87 : chr  "128" "Studiable type" "<no unit>" "Surface" ...
 $ V88 : chr  "128" "Axis name - X" "<no unit>" "X" ...
 $ V89 : chr  "128" "Axis length - X" "µm" "255.4748064" ...
 $ V90 : chr  "128" "Axis size - X" "points" "3000" ...
 $ V91 : chr  "128" "Axis spacing - X" "nm" "85.18666436" ...
 $ V92 : chr  "128" "Axis offset - X" "µm" "0" ...
 $ V93 : chr  "128" "Axis name - Y" "<no unit>" "Y" ...
 $ V94 : chr  "128" "Axis length - Y" "µm" "255.4748064" ...
 $ V95 : chr  "128" "Axis size - Y" "points" "3000" ...
 $ V96 : chr  "128" "Axis spacing - Y" "nm" "85.18666436" ...
 $ V97 : chr  "128" "Axis offset - Y" "µm" "-255.4748064" ...
 $ V98 : chr  "128" "Axis name - Z" "<no unit>" "Z" ...
 $ V99 : chr  "128" "Layer type - Z" "<no unit>" "Topography" ...
  [list output truncated]
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{format-data}{%
\section{Format data}\label{format-data}}

\hypertarget{keep-only-interesting-columns-and-rows}{%
\subsection{Keep only interesting columns and
rows}\label{keep-only-interesting-columns-and-rows}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# keeps only the columns and rows of interest for the analysis }
\NormalTok{data\_keep\_col }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\DecValTok{16}\SpecialCharTok{:}\DecValTok{17}\NormalTok{, }\DecValTok{20}\SpecialCharTok{:}\DecValTok{22}\NormalTok{, }\DecValTok{24}\SpecialCharTok{:}\DecValTok{26}\NormalTok{, }\DecValTok{29}\SpecialCharTok{:}\DecValTok{32}\NormalTok{, }\DecValTok{50}\SpecialCharTok{:}\DecValTok{83}\NormalTok{)}
\NormalTok{data\_keep\_rows }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(imp\_data[[}\DecValTok{1}\NormalTok{]] }\SpecialCharTok{!=} \StringTok{"\#"}\NormalTok{)}
\NormalTok{data\_keep }\OtherTok{\textless{}{-}}\NormalTok{ imp\_data[data\_keep\_rows, data\_keep\_col]}
\end{Highlighting}
\end{Shaded}

\hypertarget{add-headers}{%
\subsection{Add headers}\label{add-headers}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{head\_data\_keep }\OtherTok{\textless{}{-}} \FunctionTok{unlist}\NormalTok{(imp\_data[}\DecValTok{2}\NormalTok{, data\_keep\_col]) }
\FunctionTok{colnames}\NormalTok{(data\_keep) }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.+"}\NormalTok{, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{."}\NormalTok{, }\FunctionTok{make.names}\NormalTok{(head\_data\_keep))}
\FunctionTok{colnames}\NormalTok{(data\_keep) }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.$"}\NormalTok{, }\StringTok{""}\NormalTok{, }\FunctionTok{colnames}\NormalTok{(data\_keep)) }
\end{Highlighting}
\end{Shaded}

\hypertarget{identify-results-using-frame-numbers}{%
\subsection{Identify results using frame
numbers}\label{identify-results-using-frame-numbers}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# combines the results from the different analysis based on the column numbers }
\CommentTok{\# (ID from MountainsMAp)}
\NormalTok{frames }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{unlist}\NormalTok{(imp\_data[}\DecValTok{1}\NormalTok{, data\_keep\_col]))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: NAs introduced by coercion
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ID }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(frames }\SpecialCharTok{==} \DecValTok{6}\NormalTok{)[}\SpecialCharTok{{-}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)]}
\NormalTok{ISO }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(frames }\SpecialCharTok{==} \DecValTok{17}\NormalTok{)}
\NormalTok{furrow }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(frames }\SpecialCharTok{==} \DecValTok{18}\NormalTok{)}
\NormalTok{diriso }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(frames }\SpecialCharTok{\%in\%} \DecValTok{19}\SpecialCharTok{:}\DecValTok{20}\NormalTok{)}
\NormalTok{SSFA }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(frames }\SpecialCharTok{\%in\%} \DecValTok{21}\SpecialCharTok{:}\DecValTok{22}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{shorten-the-names-for-parameters}{%
\subsection{Shorten the names for
parameters}\label{shorten-the-names-for-parameters}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# keeps only the important information of the headers }
\FunctionTok{colnames}\NormalTok{(data\_keep)[ISO] }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\FunctionTok{strsplit}\NormalTok{(}\FunctionTok{names}\NormalTok{(data\_keep)[ISO], }\StringTok{"."}\NormalTok{, }\AttributeTok{fixed =} \ConstantTok{TRUE}\NormalTok{), }\StringTok{\textasciigrave{}}\AttributeTok{[[}\StringTok{\textasciigrave{}}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\FunctionTok{colnames}\NormalTok{(data\_keep)[SSFA] }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\^{}([A{-}Za{-}z0{-}9]+}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.)+"}\NormalTok{, }\StringTok{""}\NormalTok{, }\FunctionTok{colnames}\NormalTok{(data\_keep)[SSFA])}
\end{Highlighting}
\end{Shaded}

\hypertarget{save-units}{%
\subsection{Save units}\label{save-units}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# takes the units which were part of the headers and separates them; creates a data frame}
\NormalTok{var\_num }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(ID, ISO, furrow, diriso, SSFA)}
\CommentTok{\# extracts \textquotesingle{}unit\textquotesingle{} line for considered columns}
\NormalTok{units\_var }\OtherTok{\textless{}{-}} \FunctionTok{unlist}\NormalTok{(imp\_data[}\DecValTok{3}\NormalTok{, data\_keep\_col])[var\_num] }
\CommentTok{\# gets names associated to the units}
\FunctionTok{names}\NormalTok{(units\_var) }\OtherTok{\textless{}{-}}\NormalTok{ head\_data\_keep[var\_num] }
\CommentTok{\# puts all of it into a data.frame}
\NormalTok{units\_var\_table }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{variable =} \FunctionTok{names}\NormalTok{(units\_var), }\AttributeTok{unit =}\NormalTok{ units\_var) }
\end{Highlighting}
\end{Shaded}

\hypertarget{convert-to-numeric}{%
\subsection{Convert to numeric}\label{convert-to-numeric}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ var\_num) data\_keep[[i]] }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(data\_keep[[i]])}
\end{Highlighting}
\end{Shaded}

\hypertarget{split-the-column-name-into-several-columns}{%
\subsection{Split the column `Name' into several
columns}\label{split-the-column-name-into-several-columns}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# these lines extract the artefact ID out of the path name}
\NormalTok{stud\_name }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{".* {-}{-}{-} "}\NormalTok{, }\StringTok{""}\NormalTok{, data\_keep[[}\StringTok{"Name"}\NormalTok{]])}
\NormalTok{split\_name }\OtherTok{\textless{}{-}} \FunctionTok{do.call}\NormalTok{(rbind, }\FunctionTok{strsplit}\NormalTok{(stud\_name, }\StringTok{"\_"}\NormalTok{))}

\CommentTok{\# splits the ID in the separat information }
\NormalTok{data\_final }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(split\_name[,}\DecValTok{1}\NormalTok{], split\_name[,}\DecValTok{2}\NormalTok{], split\_name[,}\DecValTok{3}\NormalTok{], split\_name[,}\DecValTok{4}\NormalTok{], split\_name[,}\DecValTok{5}\NormalTok{], split\_name[,}\DecValTok{6}\NormalTok{], data\_keep[}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{], }\AttributeTok{stringsAsFactors =} \ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{colnames}\NormalTok{(data\_final)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Sample.ID"}\NormalTok{, }\StringTok{"Microscope"}\NormalTok{, }\StringTok{"Objective"}\NormalTok{, }\StringTok{"PolishType"}\NormalTok{, }\StringTok{"Surface"}\NormalTok{, }\StringTok{"Topo"}\NormalTok{, }\StringTok{"Acquisition.Date"}\NormalTok{, }\StringTok{"Analysis.Date"}\NormalTok{, }\StringTok{"Analysis.Time"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{check-the-result}{%
\subsection{Check the result}\label{check-the-result}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(data\_final)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   30 obs. of  53 variables:
 $ Sample.ID               : chr  "Kremasti4" "Kremasti4" "Kremasti4" "Kremasti4" ...
 $ Microscope              : chr  "LSM" "LSM" "LSM" "LSM" ...
 $ Objective               : chr  "50x" "50x" "50x" "50x" ...
 $ PolishType              : chr  "natural" "natural" "natural" "natural" ...
 $ Surface                 : chr  "a" "b" "c" "d" ...
 $ Topo                    : chr  "Topo" "Topo" "Topo" "Topo" ...
 $ Acquisition.Date        : chr  "2021/04/15" "2021/04/15" "2021/04/15" "2021/04/15" ...
 $ Analysis.Date           : chr  "14:06:02" "14:08:39" "14:11:12" "14:13:40" ...
 $ Analysis.Time           : chr  "4/15/2021 10:24:41 AM" "4/15/2021 10:51:24 AM" "4/15/2021 11:45:47 AM" "4/15/2021 12:01:50 PM" ...
 $ Axis.length.X           : num  255 255 255 255 255 ...
 $ Axis.size.X             : num  3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 ...
 $ Axis.spacing.X          : num  85.2 85.2 85.2 85.2 85.2 ...
 $ Axis.length.Y           : num  255 255 255 255 255 ...
 $ Axis.size.Y             : num  3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 ...
 $ Axis.spacing.Y          : num  85.2 85.2 85.2 85.2 85.2 ...
 $ Axis.length.Z           : num  40.7 49.9 92.6 31.8 29.3 ...
 $ Axis.size.Z             : num  65532 65532 65531 65532 65531 ...
 $ Axis.spacing.Z          : num  0.621 0.761 1.413 0.485 0.447 ...
 $ NM.points.ratio.Z       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Sq                      : num  1.58 4.09 1.47 2.24 1.77 ...
 $ Ssk                     : num  -0.61 -0.391 -0.274 -0.049 -0.929 ...
 $ Sku                     : num  4.88 2.53 6.23 3.44 5.87 ...
 $ Sp                      : num  5.47 10.44 5.15 9.02 7.91 ...
 $ Sv                      : num  6.86 12.48 8.2 7.06 8.52 ...
 $ Sz                      : num  12.3 22.9 13.4 16.1 16.4 ...
 $ Sa                      : num  1.13 3.4 1.08 1.77 1.25 ...
 $ Smr                     : num  0.484 0.239 0.604 0.207 0.126 ...
 $ Smc                     : num  1.69 4.56 1.72 2.87 1.66 ...
 $ Sxp                     : num  3.99 9.02 2.67 4.65 4.7 ...
 $ Sal                     : num  19.5 32.4 23.5 30.6 20.7 ...
 $ Str                     : num  0.48 NA NA 0.614 0.813 ...
 $ Std                     : num  42.2 93.2 33 25.3 62 ...
 $ Sdq                     : num  0.383 0.658 0.521 0.403 0.403 ...
 $ Sdr                     : num  6 15.94 8.53 6.73 6.56 ...
 $ Vm                      : num  0.0895 0.1529 0.1057 0.0994 0.0945 ...
 $ Vv                      : num  1.78 4.72 1.82 2.97 1.75 ...
 $ Vmp                     : num  0.0895 0.1529 0.1057 0.0994 0.0945 ...
 $ Vmc                     : num  1.13 4.14 1.09 1.84 1.28 ...
 $ Vvc                     : num  1.5 4.24 1.65 2.68 1.41 ...
 $ Vvv                     : num  0.287 0.478 0.17 0.292 0.343 ...
 $ Maximum.depth.of.furrows: num  7.22 10.88 9.43 6.76 8.68 ...
 $ Mean.depth.of.furrows   : num  1.57 3.13 1.47 1.9 1.54 ...
 $ Mean.density.of.furrows : num  3750 3056 4011 3480 3423 ...
 $ First.direction         : num  89.9772 90.014 45.0229 0.0123 44.9941 ...
 $ Second.direction        : num  45 135 180 26.5 63.5 ...
 $ Third.direction         : num  180 45 33.7 90 90 ...
 $ Texture.isotropy        : num  74 82.7 77.8 90.3 92.3 ...
 $ epLsar                  : num  NA NA NA NA NA NA NA NA NA NA ...
 $ NewEplsar               : num  NA NA NA NA NA NA NA NA NA NA ...
 $ Asfc                    : num  9.93 25.92 17.49 11.21 10.47 ...
 $ Smfc                    : num  6281985 10723090 4628049 7318909 11574299 ...
 $ HAsfc9                  : num  0.539 0.39 1.927 0.603 0.546 ...
 $ HAsfc81                 : num  0.87 0.638 2.369 0.728 0.848 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(data\_final)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sample.ID Microscope Objective PolishType Surface Topo Acquisition.Date
4 Kremasti4        LSM       50x    natural       a Topo       2021/04/15
5 Kremasti4        LSM       50x    natural       b Topo       2021/04/15
6 Kremasti4        LSM       50x    natural       c Topo       2021/04/15
7 Kremasti4        LSM       50x    natural       d Topo       2021/04/15
8 Kremasti4        LSM       50x    natural       e Topo       2021/04/15
9 Kremasti4        LSM       50x      type1       a Topo       2021/04/15
  Analysis.Date         Analysis.Time Axis.length.X Axis.size.X Axis.spacing.X
4      14:06:02 4/15/2021 10:24:41 AM      255.4748        3000       85.18666
5      14:08:39 4/15/2021 10:51:24 AM      255.4748        3000       85.18666
6      14:11:12 4/15/2021 11:45:47 AM      255.4748        3000       85.18666
7      14:13:40 4/15/2021 12:01:50 PM      255.4748        3000       85.18666
8      14:16:06 4/15/2021 12:16:18 PM      255.4748        3000       85.18666
9      14:18:42  4/13/2021 3:00:34 PM      255.4748        3000       85.18666
  Axis.length.Y Axis.size.Y Axis.spacing.Y Axis.length.Z Axis.size.Z
4      255.4748        3000       85.18666      40.71167       65532
5      255.4748        3000       85.18666      49.89209       65532
6      255.4748        3000       85.18666      92.57281       65531
7      255.4748        3000       85.18666      31.79712       65532
8      255.4748        3000       85.18666      29.31425       65531
9      255.4748        3000       85.18666      24.97545       65531
  Axis.spacing.Z NM.points.ratio.Z       Sq         Ssk      Sku        Sp
4      0.6212487                 0 1.584021 -0.60950352 4.876491  5.465870
5      0.7613393                 0 4.090417 -0.39145394 2.527444 10.438800
6      1.4126567                 0 1.471140 -0.27367641 6.226369  5.151535
7      0.4852151                 0 2.240846 -0.04897288 3.435836  9.022964
8      0.4473341                 0 1.767716 -0.92850679 5.866180  7.914458
9      0.3811242                 0 1.434170 -1.65028211 6.832436  3.630703
         Sv       Sz       Sa       Smr      Smc      Sxp      Sal       Str
4  6.859082 12.32495 1.125057 0.4839345 1.693314 3.990942 19.51575 0.4800925
5 12.482615 22.92141 3.402968 0.2388669 4.564882 9.019519 32.42663        NA
6  8.201602 13.35314 1.084219 0.6035167 1.717278 2.666714 23.54556        NA
7  7.063908 16.08687 1.765024 0.2065847 2.872713 4.647387 30.56610 0.6142008
8  8.517286 16.43174 1.248673 0.1263085 1.657583 4.698921 20.72937 0.8132318
9  7.463707 11.09441 1.009955 0.5506006 1.290805 4.246005 18.83861 0.6902008
        Std       Sdq       Sdr         Vm       Vv        Vmp      Vmc
4  42.24936 0.3826728  6.003095 0.08953457 1.782866 0.08953457 1.129501
5  93.24467 0.6584596 15.937044 0.15288943 4.717775 0.15288943 4.141595
6  33.00070 0.5207327  8.532379 0.10571506 1.823054 0.10571506 1.087074
7  25.25098 0.4030433  6.729032 0.09941242 2.972141 0.09941242 1.843508
8  62.00315 0.4031913  6.562433 0.09447176 1.752063 0.09447176 1.276085
9 148.49476 0.3498352  5.156392 0.04783352 1.338637 0.04783352 0.982558
       Vvc       Vvv Maximum.depth.of.furrows Mean.depth.of.furrows
4 1.496020 0.2868460                 7.217170              1.568997
5 4.240142 0.4776329                10.880719              3.134721
6 1.653056 0.1699981                 9.434004              1.469384
7 2.679862 0.2922788                 6.760114              1.903889
8 1.408635 0.3434273                 8.684991              1.535972
9 1.015295 0.3233419                 6.789918              1.217140
  Mean.density.of.furrows First.direction Second.direction Third.direction
4                3750.457     89.97719930         45.01151       179.99019
5                3056.415     90.01401251        134.99001        45.00416
6                4010.997     45.02286722        179.99523        33.71723
7                3479.585      0.01225454         26.47753        89.99378
8                3422.848     44.99412580         63.51278        90.01651
9                3631.833    179.98336160         89.99780       135.00711
  Texture.isotropy epLsar NewEplsar      Asfc     Smfc    HAsfc9   HAsfc81
4         73.97244     NA        NA  9.933673  6281985 0.5388613 0.8700497
5         82.66691     NA        NA 25.923849 10723090 0.3895934 0.6379997
6         77.84103     NA        NA 17.485180  4628049 1.9267261 2.3693875
7         90.31548     NA        NA 11.212214  7318909 0.6032577 0.7279640
8         92.32249     NA        NA 10.466204 11574299 0.5456690 0.8480940
9         69.99147     NA        NA  9.047928  6281985 0.2340000 0.8845739
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{save-data}{%
\section{Save data}\label{save-data}}

\hypertarget{format-name-of-output-file}{%
\subsection{Format name of output
file}\label{format-name-of-output-file}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{file\_out }\OtherTok{\textless{}{-}} \StringTok{"data"}
\end{Highlighting}
\end{Shaded}

The files will be saved as ``\textasciitilde/data.{[}ext{]}''.

\hypertarget{write-to-xlsx}{%
\subsection{Write to XLSX}\label{write-to-xlsx}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write.xlsx}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\AttributeTok{data =}\NormalTok{ data\_final, }\AttributeTok{units =}\NormalTok{ units\_var\_table), }
           \AttributeTok{file =} \FunctionTok{paste0}\NormalTok{(dir\_out, file\_out, }\StringTok{".xlsx"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{save-r-object}{%
\subsection{Save R object}\label{save-r-object}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{saveObject}\NormalTok{(data\_final, }\AttributeTok{file =} \FunctionTok{paste0}\NormalTok{(dir\_out, file\_out, }\StringTok{".Rbin"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{sessioninfo-and-rstudio-version}{%
\section{sessionInfo() and RStudio
version}\label{sessioninfo-and-rstudio-version}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
R version 4.1.0 (2021-05-18)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] tools     stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] chron_2.3-58      R.utils_2.12.2    R.oo_1.25.0       R.methodsS3_1.8.2
[5] openxlsx_4.2.5.1 

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.9      digest_0.6.31   rprojroot_2.0.3 lifecycle_1.0.3
 [5] magrittr_2.0.3  evaluate_0.19   zip_2.2.2       rlang_1.0.6    
 [9] stringi_1.7.6   cli_3.4.1       rstudioapi_0.14 vctrs_0.5.1    
[13] rmarkdown_2.19  stringr_1.5.0   glue_1.6.2      xfun_0.35      
[17] yaml_2.3.6      fastmap_1.1.0   compiler_4.1.0  htmltools_0.5.4
[21] knitr_1.41     
\end{verbatim}

\end{document}
